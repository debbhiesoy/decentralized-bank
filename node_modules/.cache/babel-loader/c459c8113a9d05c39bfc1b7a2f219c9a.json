{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar xml_http_request_event_target_1 = require(\"./xml-http-request-event-target\");\n\nvar XMLHttpRequestUpload =\n/** @class */\nfunction (_super) {\n  __extends(XMLHttpRequestUpload, _super);\n\n  function XMLHttpRequestUpload() {\n    var _this = _super.call(this) || this;\n\n    _this._contentType = null;\n    _this._body = null;\n\n    _this._reset();\n\n    return _this;\n  }\n\n  XMLHttpRequestUpload.prototype._reset = function () {\n    this._contentType = null;\n    this._body = null;\n  };\n\n  XMLHttpRequestUpload.prototype._setData = function (data) {\n    if (data == null) {\n      return;\n    }\n\n    if (typeof data === 'string') {\n      if (data.length !== 0) {\n        this._contentType = 'text/plain;charset=UTF-8';\n      }\n\n      this._body = new Buffer(data, 'utf-8');\n    } else if (Buffer.isBuffer(data)) {\n      this._body = data;\n    } else if (data instanceof ArrayBuffer) {\n      var body = new Buffer(data.byteLength);\n      var view = new Uint8Array(data);\n\n      for (var i = 0; i < data.byteLength; i++) {\n        body[i] = view[i];\n      }\n\n      this._body = body;\n    } else if (data.buffer && data.buffer instanceof ArrayBuffer) {\n      var body = new Buffer(data.byteLength);\n      var offset = data.byteOffset;\n      var view = new Uint8Array(data.buffer);\n\n      for (var i = 0; i < data.byteLength; i++) {\n        body[i] = view[i + offset];\n      }\n\n      this._body = body;\n    } else {\n      throw new Error(\"Unsupported send() data \" + data);\n    }\n  };\n\n  XMLHttpRequestUpload.prototype._finalizeHeaders = function (headers, loweredHeaders) {\n    if (this._contentType && !loweredHeaders['content-type']) {\n      headers['Content-Type'] = this._contentType;\n    }\n\n    if (this._body) {\n      headers['Content-Length'] = this._body.length.toString();\n    }\n  };\n\n  XMLHttpRequestUpload.prototype._startUpload = function (request) {\n    if (this._body) {\n      request.write(this._body);\n    }\n\n    request.end();\n  };\n\n  return XMLHttpRequestUpload;\n}(xml_http_request_event_target_1.XMLHttpRequestEventTarget);\n\nexports.XMLHttpRequestUpload = XMLHttpRequestUpload;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAGA;AAAA;AAAA;AAA0CA;;AAIzC;AAAA,gBACCC,qBAAO,IADR;;AAHQC,yBAA8B,IAA9B;AACAA,kBAAQ,IAAR;;AAIPA,SAAI,CAACC,MAAL;;;AACA;;AAEDC;AACC,SAAKC,YAAL,GAAoB,IAApB;AACA,SAAKC,KAAL,GAAa,IAAb;AACA,GAHD;;AAKAF,sDAASG,IAAT,EAA+D;AAC9D,QAAIA,IAAI,IAAI,IAAZ,EAAkB;AAAE;AAAS;;AAE7B,QAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC7B,UAAIA,IAAI,CAACC,MAAL,KAAgB,CAApB,EAAuB;AACtB,aAAKH,YAAL,GAAoB,0BAApB;AACA;;AACD,WAAKC,KAAL,GAAa,IAAIG,MAAJ,CAAWF,IAAX,EAAiB,OAAjB,CAAb;AACA,KALD,MAKO,IAAIE,MAAM,CAACC,QAAP,CAAgBH,IAAhB,CAAJ,EAA2B;AACjC,WAAKD,KAAL,GAAaC,IAAb;AACA,KAFM,MAEA,IAAIA,IAAI,YAAYI,WAApB,EAAiC;AACvC,UAAMC,IAAI,GAAG,IAAIH,MAAJ,CAAWF,IAAI,CAACM,UAAhB,CAAb;AACA,UAAMC,IAAI,GAAG,IAAIC,UAAJ,CAAeR,IAAf,CAAb;;AACA,WAAK,IAAIS,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,IAAI,CAACM,UAAzB,EAAqCG,CAAC,EAAtC,EAA0C;AAAEJ,YAAI,CAACI,CAAD,CAAJ,GAAUF,IAAI,CAACE,CAAD,CAAd;AAAoB;;AAChE,WAAKV,KAAL,GAAaM,IAAb;AACA,KALM,MAKA,IAAIL,IAAI,CAACU,MAAL,IAAeV,IAAI,CAACU,MAAL,YAAuBN,WAA1C,EAAuD;AAC7D,UAAMC,IAAI,GAAG,IAAIH,MAAJ,CAAWF,IAAI,CAACM,UAAhB,CAAb;AACA,UAAMK,MAAM,GAAGX,IAAI,CAACY,UAApB;AACA,UAAML,IAAI,GAAG,IAAIC,UAAJ,CAAeR,IAAI,CAACU,MAApB,CAAb;;AACA,WAAK,IAAID,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGT,IAAI,CAACM,UAAzB,EAAqCG,CAAC,EAAtC,EAA0C;AAAEJ,YAAI,CAACI,CAAD,CAAJ,GAAUF,IAAI,CAACE,CAAC,GAAGE,MAAL,CAAd;AAA6B;;AACzE,WAAKZ,KAAL,GAAaM,IAAb;AACA,KANM,MAMA;AACN,YAAM,IAAIQ,KAAJ,CAAU,6BAA2Bb,IAArC,CAAN;AACA;AACD,GAxBD;;AA0BAH,8DAAiBiB,OAAjB,EAAkCC,cAAlC,EAAwD;AACvD,QAAI,KAAKjB,YAAL,IAAqB,CAACiB,cAAc,CAAC,cAAD,CAAxC,EAA0D;AACzDD,aAAO,CAAC,cAAD,CAAP,GAA0B,KAAKhB,YAA/B;AACA;;AACD,QAAI,KAAKC,KAAT,EAAgB;AACfe,aAAO,CAAC,gBAAD,CAAP,GAA4B,KAAKf,KAAL,CAAWE,MAAX,CAAkBe,QAAlB,EAA5B;AACA;AACD,GAPD;;AASAnB,0DAAaoB,OAAb,EAAmC;AAClC,QAAI,KAAKlB,KAAT,EAAgB;AAAEkB,aAAO,CAACC,KAAR,CAAc,KAAKnB,KAAnB;AAA4B;;AAC9CkB,WAAO,CAACE,GAAR;AACA,GAHD;;AAID;AArDA,EAA0CC,yDAA1C;;AAAaC","names":["__extends","_super","_this","_reset","XMLHttpRequestUpload","_contentType","_body","data","length","Buffer","isBuffer","ArrayBuffer","body","byteLength","view","Uint8Array","i","buffer","offset","byteOffset","Error","headers","loweredHeaders","toString","request","write","end","xml_http_request_event_target_1","exports"],"sourceRoot":"","sources":["../xml-http-request-upload.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}